(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}})();const y=()=>{try{return window.__TAURI__.core.invoke}catch(r){return console.error("Tauri API not found!",r),null}},m=document.getElementById("loginForm"),p=document.getElementById("email"),f=document.getElementById("password"),i=document.getElementById("loginBtn"),u=i.querySelector(".btn-text"),d=i.querySelector(".btn-loader"),n=document.getElementById("errorMessage"),a=document.getElementById("successMessage"),g="https://test.asadvanceit.com/api/agent/login";m.addEventListener("submit",async r=>{r.preventDefault(),console.log("Login form submitted"),n.style.display="none",a.style.display="none";const o=y();if(!o){n.textContent="Critical Error: Tauri API not loaded. Is this running inside Tauri?",n.style.display="block";return}u.style.display="none",d.style.display="block",i.disabled=!0;const s=p.value.trim(),l=f.value;try{console.log("Calling Rust login with:",{email:s,api_url:g});const e=await o("login",{email:s,password:l,apiUrl:g});if(console.log("Rust login result:",e),e.success){a.textContent="Login successful! Opening browser...",a.style.display="block";const t=e.magic_url||e.magicUrl;await o("open_browser",{url:t})}else throw new Error(e.message||"Login failed")}catch(e){console.error("Login error:",e),n.textContent=e.message||e,n.style.display="block"}finally{u.style.display="block",d.style.display="none",i.disabled=!1}});
